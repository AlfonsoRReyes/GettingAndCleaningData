# CodeBook.md



# About the data and the sources
Human Activity Recognition Using Smartphones Dataset

## Measurements
The obtained dataset has been randomly partitioned into two sets, where 70% of the volunteers was selected for generating the training data and 30% the test data. The training data is located under the `train` folder and has been named `X_train.txt`. The test data is located under the `test` folder with the file named `X_test.txt` These files contain 561 variable names that were generated by the sensors.


## The sensors
There are two sensors from which the data is acquired: an __accelerometer__ and a __gyroscope__. Triaxal acceleration readings are collected from the accelerometer, while angular velocity in the tree axis are read from the gyroscope. Additionally these measurements are processed under two domains: time and frequency. All of these measurements total __561 variables__.



# Measurements and Auxiliary Data frames

## The `train` data frame
This shows a summary of the `train` data frame after loading the file `X_train.txt`. We call it raw data at this point.


```r
rm(list=ls(all=TRUE))
library(dplyr)
library(stringr)
```



```r
source("run_analysis.R")
train_measurements_raw <- raw_measurements_data("train")$measurements   # read test dataset: 62.9 MB
short_summary(train_measurements_raw)
```

```
Observations: 	 7352 			First variables: V1 V2 V3 V4 V5 V6 
Variables: 	 561 			Last variables: V556 V557 V558 V559 V560 V561 

First observations
         V1       V141       V281       V421        V561
1 0.2885845 -0.9786140 -0.9747327 -0.9986807 -0.05862692
2 0.2784188 -0.9893447 -0.9858116 -0.9996510 -0.05431672
3 0.2796531 -0.9951443 -0.9858213 -0.9995138 -0.04911782
4 0.2791739 -0.9941653 -0.9928120 -0.9992066 -0.04766318
5 0.2766288 -0.9933367 -0.9924232 -0.9992106 -0.04389225
6 0.2771988 -0.9929940 -0.9950023 -0.9994048 -0.04212638

Summary of selected variables
```

```
       V1               V141              V281              V421        
 Min.   :-1.0000   Min.   :-1.0000   Min.   :-1.0000   Min.   :-1.0000  
 1st Qu.: 0.2630   1st Qu.:-0.9871   1st Qu.:-0.9869   1st Qu.:-0.9995  
 Median : 0.2772   Median :-0.9356   Median :-0.9055   Median :-0.9979  
 Mean   : 0.2745   Mean   :-0.7132   Mean   :-0.5541   Mean   :-0.9291  
 3rd Qu.: 0.2885   3rd Qu.:-0.4954   3rd Qu.:-0.1051   3rd Qu.:-0.9133  
 Max.   : 1.0000   Max.   : 1.0000   Max.   : 1.0000   Max.   : 1.0000  
      V561          
 Min.   :-1.000000  
 1st Qu.:-0.143414  
 Median : 0.003181  
 Mean   :-0.056515  
 3rd Qu.: 0.107659  
 Max.   : 1.000000  
```


## The `test` data frame
This shows a summary of the `test` data frame after loading the file `X_test.txt`. We call it raw data at this point.


```r
# library(dplyr)
# source("run_analysis.R")
test_measurements_raw <- raw_measurements_data("test")$measurements
short_summary(test_measurements_raw)
```

```
Observations: 	 2947 			First variables: V1 V2 V3 V4 V5 V6 
Variables: 	 561 			Last variables: V556 V557 V558 V559 V560 V561 

First observations
         V1       V141       V281       V421        V561
1 0.2571778 -0.9061043 -0.8650632 -0.9984601 -0.05797830
2 0.2860267 -0.9606847 -0.9576235 -0.9985726 -0.08389801
3 0.2754848 -0.9861989 -0.9771138 -0.9990731 -0.07934620
4 0.2702982 -0.9716812 -0.9786883 -0.9987950 -0.07710800
5 0.2748330 -0.9815836 -0.9829645 -0.9995514 -0.07385681
6 0.2792199 -0.9820461 -0.9827866 -0.9994356 -0.06847070

Summary of selected variables
```

```
       V1               V141              V281              V421         
 Min.   :-0.5920   Min.   :-0.9990   Min.   :-0.9989   Min.   :-0.99999  
 1st Qu.: 0.2621   1st Qu.:-0.9828   1st Qu.:-0.9835   1st Qu.:-0.99944  
 Median : 0.2771   Median :-0.9148   Median :-0.8744   Median :-0.99613  
 Mean   : 0.2740   Mean   :-0.7271   Mean   :-0.5582   Mean   :-0.94097  
 3rd Qu.: 0.2881   3rd Qu.:-0.5329   3rd Qu.:-0.1423   3rd Qu.:-0.91959  
 Max.   : 0.6719   Max.   : 0.5487   Max.   : 0.5770   Max.   :-0.07175  
      V561         
 Min.   :-0.94923  
 1st Qu.:-0.09848  
 Median :-0.01067  
 Mean   :-0.04872  
 3rd Qu.: 0.09237  
 Max.   : 0.97311  
```

## Observations about the data frames for the measurements 
From the short reports printed above, we can appreciate that both data frames `train` with 7352 observations, and `test` with 2947 observations, hold the same number of variables (561), which facilitates the merging operations later. The variable names are the default and are labeled as "Vnnn" where _nnn_ is the variable number from 1 through 561. Later, these variable names will be reassigned with the ones used by the researchers.


## Subjects and Activities
The experiments have been carried out with a group of `30 volunteers` within an age bracket of 19-48 years. Each person performed six activities (`WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING`) wearing a smartphone.



### Subjects data frame for the `train` dataset
The `subjects` data frame is generated by reading the file `subject_name.txt`, where name could take either of two values: `train` or `test`. We will use this file naming convention in our advantage later by applying one common function to both data frames. Below is shown a short summary of `subjects` data frame.


```r
subject_train <- read.table("./data/UCI HAR Dataset/train/subject_train.txt") 
short_summary(subject_train)
```

```
Observations: 	 7352 			First variables: V1 
Variables: 	 1 			Last variables: V1 

First observations
  V1
1  1
2  1
3  1
4  1
5  1
6  1

Summary of selected variables
```

```
       V1       
 Min.   : 1.00  
 1st Qu.: 8.00  
 Median :19.00  
 Mean   :17.41  
 3rd Qu.:26.00  
 Max.   :30.00  
```

```r
train_subjects_raw     <- raw_measurements_data("train")$subjects 
short_summary(train_subjects_raw)
```

```
Observations: 	 7352 			First variables: V1 
Variables: 	 1 			Last variables: V1 

First observations
  V1
1  1
2  1
3  1
4  1
5  1
6  1

Summary of selected variables
```

```
       V1       
 Min.   : 1.00  
 1st Qu.: 8.00  
 Median :19.00  
 Mean   :17.41  
 3rd Qu.:26.00  
 Max.   :30.00  
```



```

Vector Class: integer
```

```
	Subject IDs: 1 3 5 6 7 8 11 14 15 16 17 19 21 22 23 25 26 27 28 29 30
```
Note that the subject IDs for the `train` data frame are not continuous from 1 through 30; some IDs are missing. These IDs will be found in the `test` data frame.



### Subjects data frame for `test` dataset
The `subjects` data frame for `test` is generated by reading the file `subject_test.txt`. Below is shown a short summary of `subjects` data frame for the `test` dataset.


```r
test_subjects_raw     <- raw_measurements_data("test")$subjects 
short_summary(test_subjects_raw)
```

```
Observations: 	 2947 			First variables: V1 
Variables: 	 1 			Last variables: V1 

First observations
  V1
1  2
2  2
3  2
4  2
5  2
6  2

Summary of selected variables
```

```
       V1       
 Min.   : 2.00  
 1st Qu.: 9.00  
 Median :12.00  
 Mean   :12.99  
 3rd Qu.:18.00  
 Max.   :24.00  
```


```

Vector Class: integer
```

```
	Subject IDs: 2 4 9 10 12 13 18 20 24
```
We now can observe that the subject IDs missing values in the `train` dataset appear in the `test` dataset, which is expected according to the rules of the experiment: _The obtained dataset has been randomly partitioned into two sets, where 70% of the volunteers was selected for generating the training data and 30% the test data._

> Later on, both subjects data frames will be merged with their corresponding measurement data frames, `train` and `test`.


## Activity labels
The activity labels are read from the file `activity_labels.txt`. We show a view of the data frame:


```r
# read activity labels. They are 6 activity label variables
# rows: 6
# V1:   activity ID
# V2:   activity description
# file: "./data/UCI HAR Dataset/activity_labels.txt"
activity_labels <<- read.table("./data/UCI HAR Dataset/activity_labels.txt")
activity_labels
```

```
  V1                 V2
1  1            WALKING
2  2   WALKING_UPSTAIRS
3  3 WALKING_DOWNSTAIRS
4  4            SITTING
5  5           STANDING
6  6             LAYING
```
The activity labels are stored in the second column of the data frame. The first column is the ID. This `ID` will be used later to merge this data frame against the measurement data frames `train` and `test`.


```
[1] "WALKING"            "WALKING_UPSTAIRS"   "WALKING_DOWNSTAIRS"
[4] "SITTING"            "STANDING"           "LAYING"            
```



## Activities data frames for `train` and `test`
In the same way as the `Subjects` data frames for `train` and `test` were structured, there are two data frames that will be used to link the activity being performed by the subject on each of the `nrow(train)` and `nrow(test)` observations, respectively. Let's take a look at the data frames:

__activity_train__


```r
train_activities_raw   <- raw_measurements_data("train")$activities 
short_summary(train_activities_raw)
```

```
Observations: 	 7352 			First variables: V1 
Variables: 	 1 			Last variables: V1 

First observations
  V1
1  5
2  5
3  5
4  5
5  5
6  5

Summary of selected variables
```

```
       V1       
 Min.   :1.000  
 1st Qu.:2.000  
 Median :4.000  
 Mean   :3.643  
 3rd Qu.:5.000  
 Max.   :6.000  
```
As we can see above, there are 7352 observations in this `activity_train` data frame. They correspond exactly with the number of observations of the `train` measurements data frame.

We can also observe that the activity IDs show 6 id numbers even though there are 7352 observations in this data frame.

```r
# uniques ID for the train activity dataframe
sort(unique(train_activities_raw$V1))
```

```
[1] 1 2 3 4 5 6
```

__activity_test__



```r
test_activities_raw   <- raw_measurements_data("test")$activities 
short_summary(test_activities_raw)
```

```
Observations: 	 2947 			First variables: V1 
Variables: 	 1 			Last variables: V1 

First observations
  V1
1  5
2  5
3  5
4  5
5  5
6  5

Summary of selected variables
```

```
       V1       
 Min.   :1.000  
 1st Qu.:2.000  
 Median :4.000  
 Mean   :3.578  
 3rd Qu.:5.000  
 Max.   :6.000  
```
As we can see above, there are 2947 observations in this `activity_test` data frame. They correspond exactly with the number of observations of the `test` measurements data frame.

We can also observe that the activity IDs show 6 id numbers even though there are 2947 observations in this data frame.

```r
# uniques ID for the test activity dataframe
sort(unique(test_activities_raw$V1))
```

```
[1] 1 2 3 4 5 6
```

# Construction and transformations of the data sets for analysis
After taking a look at the auxiliarey data frames for the subject and activities we will move on the measurements data frames. These data frames `train` and `test` contain each 561 variables but both with different amount of observations.

These data frames are in a raw form as describe here:

* They do not have descriptive names for the variables
* The measurements do not have any sort of ID variable for the subject under analysis or an ID for any kind of actovity being performed by the subject. 
* No siginificant analysis can be performed on any of these data frames; we only know that the variables are numerical.

We will need to perform several operations to have the data frames `train` and `test` ready for analysis. The operations are:

1. Read the variables names 
2. Find that all variable names are unique using function `compose_features()`
3. Mark variable names that are repeating
4. Find why the variable is repeating its name
5. Fix the names of the repeating variables
6. Convert the variable names to *nice* variables names using function `make_nice_variables()`
7. Merge the data frame with corrected variable names with the measurement data frames
8. Merge the subjects data frames with the measurements data frames
9. Merge the activity data frames with the measurement data frames
10. Remove variables that do not contain the keywords `mean` and `std`
11. Merge the two measurement data frames `train` and `test`
12. Create a summary table based on the subjects ID and activity ID applying the mean to the measurements
13. Write the summary table to a file



## Read the variables names
We start by reading the variables names from the file `features.txt`. This is performed by the code in the function `run_ana()`. The file is already living in the local folder, so we indicate the name of the file with the object `fileName` as shown in the snippet below. The `fileName` is used by the function `compose_features()` to start the work of processing operations: reading the file, creating a data frame, finding the variables that are duplicates, marking those duplicates in the data frame, converting those variables names in correct ones so the deuplicates are eliminated. Then, finally these variable names are removed from any character as per best practices dictate.

Once the variable names have been processed, an object `valid_column_names` will receive them to be later merged with the measurements data frames.


```r
  # load variable names or features
  # read variable/column names. Also called features. 561 elements.
  # rows:  561. Matches the number of columns in the measurement datasets
  # V1:    record number
  # V2:    variable name or feature
  fileName <- "./data/UCI HAR Dataset/features.txt"
  features <- read.table(fileName)
  
  # ensure valid names for the variables. 
  # rows:             561
  # columns:          1 (returning as character vector)
  # name of column:   nice
  # characteristics:  variable names. No parentheses, no duplicates, no dashes, no dots
  valid_column_names <- compose_features(features)
```


```r
valid_column_names[10:50]
```

```
 [1] "tbodyaccmaxx"          "tbodyaccmaxy"         
 [3] "tbodyaccmaxz"          "tbodyaccminx"         
 [5] "tbodyaccminy"          "tbodyaccminz"         
 [7] "tbodyaccsma"           "tbodyaccenergyx"      
 [9] "tbodyaccenergyy"       "tbodyaccenergyz"      
[11] "tbodyacciqrx"          "tbodyacciqry"         
[13] "tbodyacciqrz"          "tbodyaccentropyx"     
[15] "tbodyaccentropyy"      "tbodyaccentropyz"     
[17] "tbodyaccarcoeffx1"     "tbodyaccarcoeffx2"    
[19] "tbodyaccarcoeffx3"     "tbodyaccarcoeffx4"    
[21] "tbodyaccarcoeffy1"     "tbodyaccarcoeffy2"    
[23] "tbodyaccarcoeffy3"     "tbodyaccarcoeffy4"    
[25] "tbodyaccarcoeffz1"     "tbodyaccarcoeffz2"    
[27] "tbodyaccarcoeffz3"     "tbodyaccarcoeffz4"    
[29] "tbodyacccorrelationxy" "tbodyacccorrelationxz"
[31] "tbodyacccorrelationyz" "tgravityaccmeanx"     
[33] "tgravityaccmeany"      "tgravityaccmeanz"     
[35] "tgravityaccstdx"       "tgravityaccstdy"      
[37] "tgravityaccstdz"       "tgravityaccmadx"      
[39] "tgravityaccmady"       "tgravityaccmadz"      
[41] "tgravityaccmaxx"      
```





## Find that all variable names are unique
The detection of unique variable names is performed inside the `compose_features()` function. 



```r
  all_rows       <- get_duplicates_count(features)$all_rows
  duplicate_rows <- get_duplicates_count(features)$duplicates
  
  all_rows
```

```
[1] 561
```

```r
  duplicate_rows
```

```
[1] 126
```


We can see from the results above that there are 126 duplicate variable names out of a total of 561. We find them by using the R function `duplicated()`, reading from both sides, the beginning of the vector and from the end of the vector. We do this to force the inclusion of the original variables that were causing the repetition and not only the repeating variables. This is why the extended form of duplicated() is used: `duplicated(features$V2, fromLast = TRUE)`.


## Mark variable names that are repeating
At this point we have detected 126 duplicates. But we need a way to store the good and bad variables names for further processing. In lieue of this, we create a utility data frame called `features2` that will hold all the variable names. To mark the duplicates we add a column called `duplicate` where we store the logical status; `FALSE` if the variable is no duplicate, or `TRUE` if the variable is duplicate.



```r
  # add logical marker for duplicates
  features2 <- add_logical_marker_for_dups(features)
```


The data frame looks like this when we show just a few of the variables.

```r
features2[c(1, 100, 303, 317, 561), ]
```

```
     V1                         V2 duplicate
1     1          tBodyAcc-mean()-X     FALSE
100 100       tBodyAccJerk-iqr()-X     FALSE
303 303 fBodyAcc-bandsEnergy()-1,8      TRUE
317 317 fBodyAcc-bandsEnergy()-1,8      TRUE
561 561       angle(Z,gravityMean)     FALSE
```
It can be seen here that the rows 303 and 317, just for an example, are duplicate. If we don't remove, we could not be talking about a tidy dataset. 


## Find why the variable is repeating its name
To find out why the variables have repeating names we could take a look at the first group of variables that have this problem. The explanation is this:

* There are 126 duplicate variable names out of 561 total. These variables have something in common: they are measurements taken for three different type of bin.

* These bins have a window range with three types of steps (8, 16 and 24). And all they finish at the bin 64, for the first two, and 48 for the latter. The only thing that changes is the step. For each of these a window number is assigned.

* If we add these bins we get a total of 8, 4 and 2, or 14 bin sets. Let's see how they look:


```r
print(features2[303:319,])
```

```
     V1                           V2 duplicate
303 303   fBodyAcc-bandsEnergy()-1,8      TRUE
304 304  fBodyAcc-bandsEnergy()-9,16      TRUE
305 305 fBodyAcc-bandsEnergy()-17,24      TRUE
306 306 fBodyAcc-bandsEnergy()-25,32      TRUE
307 307 fBodyAcc-bandsEnergy()-33,40      TRUE
308 308 fBodyAcc-bandsEnergy()-41,48      TRUE
309 309 fBodyAcc-bandsEnergy()-49,56      TRUE
310 310 fBodyAcc-bandsEnergy()-57,64      TRUE
311 311  fBodyAcc-bandsEnergy()-1,16      TRUE
312 312 fBodyAcc-bandsEnergy()-17,32      TRUE
313 313 fBodyAcc-bandsEnergy()-33,48      TRUE
314 314 fBodyAcc-bandsEnergy()-49,64      TRUE
315 315  fBodyAcc-bandsEnergy()-1,24      TRUE
316 316 fBodyAcc-bandsEnergy()-25,48      TRUE
317 317   fBodyAcc-bandsEnergy()-1,8      TRUE
318 318  fBodyAcc-bandsEnergy()-9,16      TRUE
319 319 fBodyAcc-bandsEnergy()-17,24      TRUE
```
On purpose, two bin sets are included to notice the repetition. This is clear in rows 303 and 317, the variable names start repeating.


```r
print(features2[c(303,317),])
```

```
     V1                         V2 duplicate
303 303 fBodyAcc-bandsEnergy()-1,8      TRUE
317 317 fBodyAcc-bandsEnergy()-1,8      TRUE
```



## Dealing with the repeating columns
These 126 variable names are corrected by adding their bin window and the corresponding axis for the observation. There are three axis: x, y and z. For instance, if the correction by window and axis is not performed, then a variable name such as fnnxnxn() would repeat three times per axis, per bin window. There are 3 kinds of bin windows and 14 bins per axis. Since there are three axis, we end up with 14 x 3 x 3 = 126 variable names that will be finally corrected.

This is what will be done: (1) get the bin window range which has three types of steps (8, 16 and 24); (2) calculate the step and apply the corresponding bin window name (w1, w2 or w3); (3) assign the axis to a column; (4) perform the concatenation of the original variable name with its corresponding bin window name and axis. 


We find that there are 3 groups of variables:

* fBodyAcc-bandsEnergy
* fBodyAccJerk-bandsEnergy
* fBodyGyro-bandsEnergy

Each of this variables have 42 energy measurements on three different windows (w1, w2, w3), and on three different axis (X, Y, Z). These variables need to be renamed accordingly to avoid repeating name of the columns.

The windows have different resolutions: `w1` has 8 steps bins like this: 1-8, [9, 16], [17, 24], [25, 32], [33, 40], [41, 48], [49, 56] and [56, 64]. `w2` has a 16 steps bins: [1, 16], [17, 32], [33, 48] and [49, 64]. `w3` has a step of 24 bins: [1, 24] and [25, 48]; id doesn't go up to 64.

These three windows (w1, w2, w3) read over the X, Y and Z axis. To differentiate the repeating columns we will have to add the axis to each of the windows.

The following code makes possible to add the bin windows and axis for the measurement. 



```r
  # get subset of features. working only with subset of duplicates
  features_dup <- fix_duplicates(features2)
```


The variables after the correction will look like this:


```r
features_dup$V2[features_dup$V1 == "303" | features_dup$V1 == "317"]
```

```
[1] "fBodyAcc-bandsEnergy()-1,8-w1-x" "fBodyAcc-bandsEnergy()-1,8-w1-y"
```
This fixes the problem with the duplicate variable names. Next, is to remove the dashes, underscores, capitalization, dots from the variable names.

## Making nice variable names


```r
  # merge the original dataframe with the duplicates dataframe
  features_merged <- merge_with_duplicates(features2, features_dup)
  
  features_nice <- convert_to_nice_names(features_merged)
  
  features_nice[303:317, c("original", "nice")]    # return only one column. Use only in the CodeBook.md
```

```
                        original                       nice
303   fBodyAcc-bandsEnergy()-1,8   fbodyaccbandsenergy18w1x
304  fBodyAcc-bandsEnergy()-9,16  fbodyaccbandsenergy916w1x
305 fBodyAcc-bandsEnergy()-17,24 fbodyaccbandsenergy1724w1x
306 fBodyAcc-bandsEnergy()-25,32 fbodyaccbandsenergy2532w1x
307 fBodyAcc-bandsEnergy()-33,40 fbodyaccbandsenergy3340w1x
308 fBodyAcc-bandsEnergy()-41,48 fbodyaccbandsenergy4148w1x
309 fBodyAcc-bandsEnergy()-49,56 fbodyaccbandsenergy4956w1x
310 fBodyAcc-bandsEnergy()-57,64 fbodyaccbandsenergy5764w1x
311  fBodyAcc-bandsEnergy()-1,16  fbodyaccbandsenergy116w2x
312 fBodyAcc-bandsEnergy()-17,32 fbodyaccbandsenergy1732w2x
313 fBodyAcc-bandsEnergy()-33,48 fbodyaccbandsenergy3348w2x
314 fBodyAcc-bandsEnergy()-49,64 fbodyaccbandsenergy4964w2x
315  fBodyAcc-bandsEnergy()-1,24  fbodyaccbandsenergy124w3x
316 fBodyAcc-bandsEnergy()-25,48 fbodyaccbandsenergy2548w3x
317   fBodyAcc-bandsEnergy()-1,8   fbodyaccbandsenergy18w1y
```

We can see now that the duplicate problem has been fixed. Both, the original variable name and the new name or nice, are shown side by side. Additionally, it can be noticed at the end that the row 317, which was a duplicate value of row 303, now it is showing corrected on the `nice` column.



## Assign descriptive names to the train data set
Now that the variable names have been fixed regarding the duplicates and the naming convention, it is time to assign these variable names to the measurements data frames `train` and `test`. The process to fix the variable names is all performed inside the function `compose_features()`. This functions returns a vector of corrected or fixed names which will be assigned to the variable `valid_column_names`. Like this:

                        `valid_column_names <<- compose_features(fileName)`

This variable is then used inside the function `compose()` where it is used to replace the original variable names in the data frames `train` and `test`. 


The `compose` function receives the name of the dataset, for instance, `train` or `test`, will replace this string in the file name objects:

      measurements_fn <- "./data/UCI HAR Dataset/file/X_file.txt"
      activities_fn   <- "./data/UCI HAR Dataset/file/y_file.txt"
      subjects_fn     <- "./data/UCI HAR Dataset/file/subject_file.txt"
      
by using the `gsub()` function:

    ds_files_v <- c(measurements_fn, activities_fn, subjects_fn)   # a vector of files to read
    ds_files   <- gsub("file", ds_name, ds_files_v)                # switch the identifier "_file" by "_train" or "_test"
    
replacing the keyword _file_ by `test` or `train`. Then, will proceed to read the corresponding files and create the data frames:

    measurements <- read.table(ds_files[1])
    activities   <- read.table(ds_files[2])
    subjects     <- read.table(ds_files[3])


Let's see how this is done showing the before and after. This is just a little part of the code for explanation purposes. The complete code is in the script `run_analysis.R`.

This reads the data from the `train` dataset file:

    train_measurements_raw <- raw_measurements_data("train")$measurements   # read test dataset: 62.9 MB
    test_measurements_raw  <- raw_measurements_data("test")$measurements


At this point, then, we have just have raw data in the table. Let's take a look at the data frame variable names:


```r
head(names(train_measurements_raw))
```

```
[1] "V1" "V2" "V3" "V4" "V5" "V6"
```

```r
tail(names(train_measurements_raw))
```

```
[1] "V556" "V557" "V558" "V559" "V560" "V561"
```
These are the variable names from the raw data frame. Let's see them after they are reassigned after the variable names have been fixed. We will use the function `compose()` which make this transformation when we send `ds_name` with the `train` dataset name:




```r
  # assign correct variable names to measurement data frames
  # add column names to measurements. assign features to variables in measurements datasets
  train_measurements <- assign_valid_names(train_measurements_raw, valid_column_names)
  test_measurements  <- assign_valid_names(test_measurements_raw,  valid_column_names)
```


And we show few of the variable names: 

```r
names(train_measurements[10:20])
```

```
 [1] "tbodyaccmaxx"    "tbodyaccmaxy"    "tbodyaccmaxz"   
 [4] "tbodyaccminx"    "tbodyaccminy"    "tbodyaccminz"   
 [7] "tbodyaccsma"     "tbodyaccenergyx" "tbodyaccenergyy"
[10] "tbodyaccenergyz" "tbodyacciqrx"   
```


```r
names(test_measurements[10:20])
```

```
 [1] "tbodyaccmaxx"    "tbodyaccmaxy"    "tbodyaccmaxz"   
 [4] "tbodyaccminx"    "tbodyaccminy"    "tbodyaccminz"   
 [7] "tbodyaccsma"     "tbodyaccenergyx" "tbodyaccenergyy"
[10] "tbodyaccenergyz" "tbodyacciqrx"   
```


We see that that the `train` data frame has now correct, fixed, non-duplicate names as well as any special characters have been removed. 

__According to the recommendations from Jeff Leek during the class we should not allow spaces, underscores, dashes, capital letters or uppercase. Lowercase is preferred.__

We do the same thing for the `test` data frame using the `compose()` function. Now, we will select only the variable names that have the keywords `mean` and `std` (for standard deviation).


## Keeping only the mean and std-dev variables


```r
  # Keep only mean and std-dev variables in measurements dataset 
  
  keywords <- c("mean", "std")
  train_measurements_select <- select_columns_with_expression(train_measurements, keywords)
  test_measurements_select  <- select_columns_with_expression(test_measurements,  keywords)
  
  length(train_measurements_select)
```

```
[1] 86
```

```r
  length(test_measurements_select)
```

```
[1] 86
```
Originally there were 7352 columns.

## Read subjects dataset

    train_subjects_raw     <- raw_measurements_data("train")$subjects 
    test_subjects_raw     <- raw_measurements_data("test")$subjects 


```r
  unique(train_subjects_raw$V1)
```

```
 [1]  1  3  5  6  7  8 11 14 15 16 17 19 21 22 23 25 26 27 28 29 30
```

```r
  unique(test_subjects_raw$V1)
```

```
[1]  2  4  9 10 12 13 18 20 24
```


## Merging datasets
This action has 3 parts:

1. Merging the train_activities table with the activities table (with descriptive names)

2. Merging the joined table above (train_activities_inner) with the train measurments dataset.

3. Merging the subjects table with train table


```r
  # add activity labels to raw activities
  train_activities_with_labels <- merge_activity_labels(train_activities_raw, activity_labels)
  test_activities_with_labels  <- merge_activity_labels(test_activities_raw,  activity_labels)
  
  # merge measurements, activities and subjects
  train_merged <- merge_all(train_measurements_select, train_activities_with_labels, train_subjects_raw)
  test_merged  <- merge_all(test_measurements_select,  test_activities_with_labels,  test_subjects_raw)
  
  # merge the measurement datasets for training and testing
  # rows:     10299
  # columns:  92
  # contains: (1) measurements for training and tests; (2) subjects; (3) activities
  train_test_merged <<- rbind(train_merged, test_merged) %>%
    mutate(row_num = row_number())      # add row_num to be able to reorder table in the future
```


```r
  cat("train activities merged with labels\t")
```

```
train activities merged with labels	
```

```r
  str(train_activities_with_labels)
```

```
'data.frame':	7352 obs. of  3 variables:
 $ activity_id    : int  5 5 5 5 5 5 5 5 5 5 ...
 $ activity_rownum: int  1 2 3 4 5 6 7 8 9 10 ...
 $ activity_name  : Factor w/ 6 levels "LAYING","SITTING",..: 3 3 3 3 3 3 3 3 3 3 ...
```

```r
  cat("\ntest activities merged with labels\t")
```

```

test activities merged with labels	
```

```r
  str(test_activities_with_labels)
```

```
'data.frame':	2947 obs. of  3 variables:
 $ activity_id    : int  5 5 5 5 5 5 5 5 5 5 ...
 $ activity_rownum: int  1 2 3 4 5 6 7 8 9 10 ...
 $ activity_name  : Factor w/ 6 levels "LAYING","SITTING",..: 3 3 3 3 3 3 3 3 3 3 ...
```

```r
  cat("\ntrain merged with activities and subjects\t")
```

```

train merged with activities and subjects	
```

```r
  str(train_merged[1:25])
```

```
'data.frame':	7352 obs. of  25 variables:
 $ subjects_id      : int  1 1 1 1 1 1 1 1 1 1 ...
 $ activity_id      : int  5 5 5 5 5 5 5 5 5 5 ...
 $ activity_name    : Factor w/ 6 levels "LAYING","SITTING",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ tbodyaccmeanx    : num  0.289 0.278 0.28 0.279 0.277 ...
 $ tbodyaccmeany    : num  -0.0203 -0.0164 -0.0195 -0.0262 -0.0166 ...
 $ tbodyaccmeanz    : num  -0.133 -0.124 -0.113 -0.123 -0.115 ...
 $ tbodyaccstdx     : num  -0.995 -0.998 -0.995 -0.996 -0.998 ...
 $ tbodyaccstdy     : num  -0.983 -0.975 -0.967 -0.983 -0.981 ...
 $ tbodyaccstdz     : num  -0.914 -0.96 -0.979 -0.991 -0.99 ...
 $ tgravityaccmeanx : num  0.963 0.967 0.967 0.968 0.968 ...
 $ tgravityaccmeany : num  -0.141 -0.142 -0.142 -0.144 -0.149 ...
 $ tgravityaccmeanz : num  0.1154 0.1094 0.1019 0.0999 0.0945 ...
 $ tgravityaccstdx  : num  -0.985 -0.997 -1 -0.997 -0.998 ...
 $ tgravityaccstdy  : num  -0.982 -0.989 -0.993 -0.981 -0.988 ...
 $ tgravityaccstdz  : num  -0.878 -0.932 -0.993 -0.978 -0.979 ...
 $ tbodyaccjerkmeanx: num  0.078 0.074 0.0736 0.0773 0.0734 ...
 $ tbodyaccjerkmeany: num  0.005 0.00577 0.0031 0.02006 0.01912 ...
 $ tbodyaccjerkmeanz: num  -0.06783 0.02938 -0.00905 -0.00986 0.01678 ...
 $ tbodyaccjerkstdx : num  -0.994 -0.996 -0.991 -0.993 -0.996 ...
 $ tbodyaccjerkstdy : num  -0.988 -0.981 -0.981 -0.988 -0.988 ...
 $ tbodyaccjerkstdz : num  -0.994 -0.992 -0.99 -0.993 -0.992 ...
 $ tbodygyromeanx   : num  -0.0061 -0.0161 -0.0317 -0.0434 -0.034 ...
 $ tbodygyromeany   : num  -0.0314 -0.0839 -0.1023 -0.0914 -0.0747 ...
 $ tbodygyromeanz   : num  0.1077 0.1006 0.0961 0.0855 0.0774 ...
 $ tbodygyrostdx    : num  -0.985 -0.983 -0.976 -0.991 -0.985 ...
```

```r
  cat("\ntest merged with activities and subjects\t")
```

```

test merged with activities and subjects	
```

```r
  str(test_merged[1:25])
```

```
'data.frame':	2947 obs. of  25 variables:
 $ subjects_id      : int  2 2 2 2 2 2 2 2 2 2 ...
 $ activity_id      : int  5 5 5 5 5 5 5 5 5 5 ...
 $ activity_name    : Factor w/ 6 levels "LAYING","SITTING",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ tbodyaccmeanx    : num  0.257 0.286 0.275 0.27 0.275 ...
 $ tbodyaccmeany    : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
 $ tbodyaccmeanz    : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
 $ tbodyaccstdx     : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
 $ tbodyaccstdy     : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
 $ tbodyaccstdz     : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
 $ tgravityaccmeanx : num  0.936 0.927 0.93 0.929 0.927 ...
 $ tgravityaccmeany : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
 $ tgravityaccmeanz : num  0.115 0.153 0.146 0.143 0.138 ...
 $ tgravityaccstdx  : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
 $ tgravityaccstdy  : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
 $ tgravityaccstdz  : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
 $ tbodyaccjerkmeanx: num  0.072 0.0702 0.0694 0.0749 0.0784 ...
 $ tbodyaccjerkmeany: num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
 $ tbodyaccjerkmeanz: num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
 $ tbodyaccjerkstdx : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
 $ tbodyaccjerkstdy : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
 $ tbodyaccjerkstdz : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
 $ tbodygyromeanx   : num  0.11998 -0.00155 -0.04821 -0.05664 -0.05999 ...
 $ tbodygyromeany   : num  -0.0918 -0.1873 -0.1663 -0.126 -0.0847 ...
 $ tbodygyromeanz   : num  0.1896 0.1807 0.1542 0.1183 0.0787 ...
 $ tbodygyrostdx    : num  -0.883 -0.926 -0.973 -0.968 -0.975 ...
```

```r
  cat("Total merge of train and test data frames")
```

```
Total merge of train and test data frames
```

```r
  # short_summary((train_test_merged))
  head(train_test_merged)
```

```
  subjects_id activity_id activity_name tbodyaccmeanx tbodyaccmeany
1           1           5      STANDING     0.2885845   -0.02029417
2           1           5      STANDING     0.2784188   -0.01641057
3           1           5      STANDING     0.2796531   -0.01946716
4           1           5      STANDING     0.2791739   -0.02620065
5           1           5      STANDING     0.2766288   -0.01656965
6           1           5      STANDING     0.2771988   -0.01009785
  tbodyaccmeanz tbodyaccstdx tbodyaccstdy tbodyaccstdz tgravityaccmeanx
1    -0.1329051   -0.9952786   -0.9831106   -0.9135264        0.9633961
2    -0.1235202   -0.9982453   -0.9753002   -0.9603220        0.9665611
3    -0.1134617   -0.9953796   -0.9671870   -0.9789440        0.9668781
4    -0.1232826   -0.9960915   -0.9834027   -0.9906751        0.9676152
5    -0.1153619   -0.9981386   -0.9808173   -0.9904816        0.9682244
6    -0.1051373   -0.9973350   -0.9904868   -0.9954200        0.9679482
  tgravityaccmeany tgravityaccmeanz tgravityaccstdx tgravityaccstdy
1       -0.1408397       0.11537494      -0.9852497      -0.9817084
2       -0.1415513       0.10937881      -0.9974113      -0.9894474
3       -0.1420098       0.10188392      -0.9995740      -0.9928658
4       -0.1439765       0.09985014      -0.9966456      -0.9813928
5       -0.1487502       0.09448590      -0.9984293      -0.9880982
6       -0.1482100       0.09190972      -0.9989793      -0.9867539
  tgravityaccstdz tbodyaccjerkmeanx tbodyaccjerkmeany tbodyaccjerkmeanz
1      -0.8776250        0.07799634       0.005000803      -0.067830808
2      -0.9316387        0.07400671       0.005771104       0.029376633
3      -0.9929172        0.07363596       0.003104037      -0.009045631
4      -0.9784764        0.07732061       0.020057642      -0.009864772
5      -0.9787449        0.07344436       0.019121574       0.016779979
6      -0.9973064        0.07793244       0.018684046       0.009344434
  tbodyaccjerkstdx tbodyaccjerkstdy tbodyaccjerkstdz tbodygyromeanx
1       -0.9935191       -0.9883600       -0.9935750   -0.006100849
2       -0.9955481       -0.9810636       -0.9918457   -0.016111620
3       -0.9907428       -0.9809556       -0.9896866   -0.031698294
4       -0.9926974       -0.9875527       -0.9934976   -0.043409983
5       -0.9964202       -0.9883587       -0.9924549   -0.033960416
6       -0.9948136       -0.9887145       -0.9922663   -0.028775508
  tbodygyromeany tbodygyromeanz tbodygyrostdx tbodygyrostdy tbodygyrostdz
1    -0.03136479     0.10772540    -0.9853103    -0.9766234    -0.9922053
2    -0.08389378     0.10058429    -0.9831200    -0.9890458    -0.9891212
3    -0.10233542     0.09612688    -0.9762921    -0.9935518    -0.9863787
4    -0.09138618     0.08553770    -0.9913848    -0.9924073    -0.9875542
5    -0.07470803     0.07739203    -0.9851836    -0.9923781    -0.9874019
6    -0.07039311     0.07901214    -0.9851808    -0.9921175    -0.9830768
  tbodygyrojerkmeanx tbodygyrojerkmeany tbodygyrojerkmeanz
1        -0.09916740        -0.05551737        -0.06198580
2        -0.11050283        -0.04481873        -0.05924282
3        -0.10848567        -0.04241031        -0.05582883
4        -0.09116989        -0.03633262        -0.06046466
5        -0.09077010        -0.03763253        -0.05828932
6        -0.09424758        -0.04335526        -0.04193600
  tbodygyrojerkstdx tbodygyrojerkstdy tbodygyrojerkstdz tbodyaccmagmean
1        -0.9921107        -0.9925193        -0.9920553      -0.9594339
2        -0.9898726        -0.9972926        -0.9938510      -0.9792892
3        -0.9884618        -0.9956321        -0.9915318      -0.9837031
4        -0.9911194        -0.9966410        -0.9933289      -0.9865418
5        -0.9913545        -0.9964730        -0.9945110      -0.9928271
6        -0.9916216        -0.9960147        -0.9930906      -0.9942950
  tbodyaccmagstd tgravityaccmagmean tgravityaccmagstd tbodyaccjerkmagmean
1     -0.9505515         -0.9594339        -0.9505515          -0.9933059
2     -0.9760571         -0.9792892        -0.9760571          -0.9912535
3     -0.9880196         -0.9837031        -0.9880196          -0.9885313
4     -0.9864213         -0.9865418        -0.9864213          -0.9930780
5     -0.9912754         -0.9928271        -0.9912754          -0.9934800
6     -0.9952490         -0.9942950        -0.9952490          -0.9930177
  tbodyaccjerkmagstd tbodygyromagmean tbodygyromagstd tbodygyrojerkmagmean
1         -0.9943364       -0.9689591      -0.9643352           -0.9942478
2         -0.9916944       -0.9806831      -0.9837542           -0.9951232
3         -0.9903969       -0.9763171      -0.9860515           -0.9934032
4         -0.9933808       -0.9820599      -0.9873511           -0.9955022
5         -0.9958537       -0.9852037      -0.9890626           -0.9958076
6         -0.9954243       -0.9858944      -0.9864403           -0.9952748
  tbodygyrojerkmagstd fbodyaccmeanx fbodyaccmeany fbodyaccmeanz
1          -0.9913676    -0.9947832    -0.9829841    -0.9392687
2          -0.9961016    -0.9974507    -0.9768517    -0.9735227
3          -0.9950910    -0.9935941    -0.9725115    -0.9833040
4          -0.9952666    -0.9954906    -0.9835697    -0.9910798
5          -0.9952580    -0.9972859    -0.9823010    -0.9883694
6          -0.9952050    -0.9966567    -0.9869395    -0.9927386
  fbodyaccstdx fbodyaccstdy fbodyaccstdz fbodyaccmeanfreqx
1   -0.9954217   -0.9831330   -0.9061650        0.25248290
2   -0.9986803   -0.9749298   -0.9554381        0.27130855
3   -0.9963128   -0.9655059   -0.9770493        0.12453124
4   -0.9963121   -0.9832444   -0.9902291        0.02904438
5   -0.9986065   -0.9801295   -0.9919150        0.18108977
6   -0.9976438   -0.9922637   -0.9970459        0.15738377
  fbodyaccmeanfreqy fbodyaccmeanfreqz fbodyaccjerkmeanx fbodyaccjerkmeany
1        0.13183575       -0.05205025        -0.9923325        -0.9871699
2        0.04286364       -0.01430976        -0.9950322        -0.9813115
3       -0.06461056        0.08267692        -0.9909937        -0.9816423
4        0.08030227        0.18569468        -0.9944466        -0.9887272
5        0.05798789        0.55978632        -0.9962920        -0.9887900
6        0.31883523        0.60559943        -0.9948507        -0.9882443
  fbodyaccjerkmeanz fbodyaccjerkstdx fbodyaccjerkstdy fbodyaccjerkstdz
1        -0.9896961       -0.9958207       -0.9909363       -0.9970517
2        -0.9897398       -0.9966523       -0.9820839       -0.9926268
3        -0.9875663       -0.9912488       -0.9814148       -0.9904159
4        -0.9913542       -0.9913783       -0.9869269       -0.9943908
5        -0.9906244       -0.9969025       -0.9886067       -0.9929065
6        -0.9901575       -0.9952180       -0.9901788       -0.9930667
  fbodyaccjerkmeanfreqx fbodyaccjerkmeanfreqy fbodyaccjerkmeanfreqz
1            0.87038451            0.21069700            0.26370789
2            0.60851352           -0.05367561            0.06314827
3            0.11543400           -0.19343634            0.03825433
4            0.03579805           -0.09303585            0.16809523
5            0.27335020            0.07913538            0.29238418
6            0.32883589            0.05477140            0.32094497
  fbodygyromeanx fbodygyromeany fbodygyromeanz fbodygyrostdx fbodygyrostdy
1     -0.9865744     -0.9817615     -0.9895148    -0.9850326    -0.9738861
2     -0.9773867     -0.9925300     -0.9896058    -0.9849043    -0.9871681
3     -0.9754332     -0.9937147     -0.9867557    -0.9766422    -0.9933990
4     -0.9871096     -0.9936015     -0.9871913    -0.9928104    -0.9916460
5     -0.9824465     -0.9929838     -0.9886664    -0.9859818    -0.9919558
6     -0.9848902     -0.9927862     -0.9807784    -0.9852871    -0.9916595
  fbodygyrostdz fbodygyromeanfreqx fbodygyromeanfreqy fbodygyromeanfreqz
1    -0.9940349        -0.25754888         0.09794711         0.54715105
2    -0.9897847        -0.04816744        -0.40160791        -0.06817833
3    -0.9873282        -0.21668507        -0.01726417        -0.11072029
4    -0.9886776         0.21686246        -0.13524536        -0.04972798
5    -0.9879443        -0.15334258        -0.08840273        -0.16223039
6    -0.9853661        -0.36303968        -0.13323831         0.19483324
  fbodyaccmagmean fbodyaccmagstd fbodyaccmagmeanfreq
1      -0.9521547     -0.9561340         -0.08843612
2      -0.9808566     -0.9758658         -0.04414989
3      -0.9877948     -0.9890155          0.25789914
4      -0.9875187     -0.9867420          0.07358150
5      -0.9935909     -0.9900635          0.39431033
6      -0.9948360     -0.9952833          0.43796212
  fbodybodyaccjerkmagmean fbodybodyaccjerkmagstd
1              -0.9937257             -0.9937550
2              -0.9903355             -0.9919603
3              -0.9892801             -0.9908667
4              -0.9927689             -0.9916998
5              -0.9955228             -0.9943890
6              -0.9947329             -0.9951562
  fbodybodyaccjerkmagmeanfreq fbodybodygyromagmean fbodybodygyromagstd
1                   0.3469885           -0.9801349          -0.9613094
2                   0.5320605           -0.9882956          -0.9833219
3                   0.6607950           -0.9892548          -0.9860277
4                   0.6789213           -0.9894128          -0.9878358
5                   0.5590577           -0.9914330          -0.9890594
6                   0.2469096           -0.9905000          -0.9858609
  fbodybodygyromagmeanfreq fbodybodygyrojerkmagmean
1               -0.1289889               -0.9919904
2               -0.2719585               -0.9958539
3               -0.2127279               -0.9950305
4               -0.0356842               -0.9952207
5               -0.2735820               -0.9950928
6               -0.2973291               -0.9951433
  fbodybodygyrojerkmagstd fbodybodygyrojerkmagmeanfreq
1              -0.9906975                  -0.07432303
2              -0.9963995                   0.15807454
3              -0.9951274                   0.41450281
4              -0.9952369                   0.40457253
5              -0.9954648                   0.08775301
6              -0.9952387                   0.01995331
  angletbodyaccmeangravity angletbodyaccjerkmeangravitymean
1              -0.11275434                      0.030400372
2               0.05347695                     -0.007434566
3              -0.11855926                      0.177899480
4              -0.03678797                     -0.012892494
5               0.12332005                      0.122541960
6               0.08263215                     -0.143439010
  angletbodygyromeangravitymean angletbodygyrojerkmeangravitymean
1                    -0.4647614                       -0.01844588
2                    -0.7326262                        0.70351059
3                     0.1006992                        0.80852908
4                     0.6400110                       -0.48536645
5                     0.6935783                       -0.61597061
6                     0.2750408                       -0.36822404
  anglexgravitymean angleygravitymean anglezgravitymean source  src_rownum
1        -0.8412468         0.1799406       -0.05862692  train train_00001
2        -0.8447876         0.1802889       -0.05431672  train train_00002
3        -0.8489335         0.1806373       -0.04911782  train train_00003
4        -0.8486494         0.1819348       -0.04766318  train train_00004
5        -0.8478653         0.1851512       -0.04389225  train train_00005
6        -0.8496316         0.1848225       -0.04212638  train train_00006
  row_num
1       1
2       2
3       3
4       4
5       5
6       6
```

```r
  tail(train_test_merged)
```

```
      subjects_id activity_id    activity_name tbodyaccmeanx tbodyaccmeany
10294          24           2 WALKING_UPSTAIRS     0.1922746   -0.03364257
10295          24           2 WALKING_UPSTAIRS     0.3101546   -0.05339125
10296          24           2 WALKING_UPSTAIRS     0.3633846   -0.03921402
10297          24           2 WALKING_UPSTAIRS     0.3499661    0.03007744
10298          24           2 WALKING_UPSTAIRS     0.2375938    0.01846687
10299          24           2 WALKING_UPSTAIRS     0.1536272   -0.01843651
      tbodyaccmeanz tbodyaccstdx tbodyaccstdy tbodyaccstdz
10294   -0.10594911   -0.3548408  -0.09250435   -0.3129097
10295   -0.09910872   -0.2878663  -0.14058918   -0.2150877
10296   -0.10591509   -0.3053880   0.02814774   -0.1963729
10297   -0.11578796   -0.3296381  -0.04214289   -0.2501807
10298   -0.09649893   -0.3231143  -0.22977539   -0.2075736
10299   -0.13701846   -0.3300460  -0.19525335   -0.1643388
      tgravityaccmeanx tgravityaccmeany tgravityaccmeanz tgravityaccstdx
10294        0.8891608       -0.2875003       -0.2266255      -0.9831356
10295        0.8909677       -0.2767180       -0.2315935      -0.9807982
10296        0.8912809       -0.2749762       -0.2280502      -0.9817830
10297        0.8908972       -0.2761645       -0.2262558      -0.9828841
10298        0.8927357       -0.2623564       -0.2351080      -0.9859829
10299        0.8943309       -0.2614073       -0.2361121      -0.9847364
      tgravityaccstdy tgravityaccstdz tbodyaccjerkmeanx tbodyaccjerkmeany
10294      -0.9518960      -0.9606073       -0.20692245        0.34231930
10295      -0.9203893      -0.9494664       -0.08800546       -0.23149161
10296      -0.9295222      -0.9346775        0.14876453       -0.34446444
10297      -0.9333010      -0.9400140        0.04632680       -0.17497360
10298      -0.9621989      -0.9489939        0.33455894       -0.05912225
10299      -0.9645770      -0.9623691        0.22380428        0.25668687
      tbodyaccjerkmeanz tbodyaccjerkstdx tbodyaccjerkstdy tbodyaccjerkstdz
10294        0.39761326       -0.4914103       -0.5116664       -0.6060667
10295        0.03601473       -0.4167254       -0.5212051       -0.5431463
10296       -0.13128210       -0.3620992       -0.4023177       -0.5291683
10297        0.20084196       -0.3893490       -0.4320439       -0.5453444
10298        0.02002424       -0.4418078       -0.5788833       -0.4903575
10299        0.01281710       -0.4790768       -0.5687591       -0.4170744
      tbodygyromeanx tbodygyromeany tbodygyromeanz tbodygyrostdx
10294     0.09440037    -0.12238811     0.01183796    -0.3387285
10295    -0.14247281     0.02544275     0.20286208    -0.5627386
10296     0.06210732    -0.04315641     0.11359406    -0.4640369
10297    -0.12371500     0.08631957     0.26142304    -0.4219774
10298    -0.33591203     0.09934677     0.35505812    -0.6678579
10299    -0.20822948    -0.03865400     0.24610106    -0.6166534
      tbodygyrostdy tbodygyrostdz tbodygyrojerkmeanx tbodygyrojerkmeany
10294    -0.5922064    -0.2908849        -0.28306686        0.025152270
10295    -0.5268550    -0.2567564         0.13828793       -0.005041591
10296    -0.5181490    -0.1396287        -0.20074200        0.069037389
10297    -0.5570594    -0.1975039        -0.36210021       -0.303347310
10298    -0.5551660    -0.3426199        -0.05582278       -0.103685680
10299    -0.5085570    -0.3138543        -0.02814551        0.173651560
      tbodygyrojerkmeanz tbodygyrojerkstdx tbodygyrojerkstdy
10294       -0.211652970        -0.6338876        -0.6788214
10295       -0.279400710        -0.6646345        -0.6049332
10296       -0.259789700        -0.5984058        -0.5946965
10297        0.172746460        -0.6124836        -0.6281620
10298        0.314818590        -0.7150106        -0.6623249
10299        0.001372617        -0.6857578        -0.6194253
      tbodygyrojerkstdz tbodyaccmagmean tbodyaccmagstd tgravityaccmagmean
10294        -0.6661600      -0.2406080     -0.3271390         -0.2406080
10295        -0.6670702      -0.2008855     -0.2343877         -0.2008855
10296        -0.6417382      -0.1705631     -0.1986268         -0.1705631
10297        -0.6161555      -0.2076032     -0.2523881         -0.2076032
10298        -0.7009483      -0.2338657     -0.2927046         -0.2338657
10299        -0.6872994      -0.2243090     -0.2624866         -0.2243090
      tgravityaccmagstd tbodyaccjerkmagmean tbodyaccjerkmagstd
10294        -0.3271390          -0.4878543         -0.5327182
10295        -0.2343877          -0.4559232         -0.4126706
10296        -0.1986268          -0.4257498         -0.2880653
10297        -0.2523881          -0.4632321         -0.2923697
10298        -0.2927046          -0.4864946         -0.3621037
10299        -0.2624866          -0.4624043         -0.3710656
      tbodygyromagmean tbodygyromagstd tbodygyrojerkmagmean
10294       -0.3005265      -0.4007543           -0.6639914
10295       -0.3937639      -0.4789186           -0.6494828
10296       -0.3031531      -0.4765808           -0.6322312
10297       -0.2886459      -0.5303024           -0.6497476
10298       -0.3789522      -0.5472317           -0.6966865
10299       -0.4085228      -0.4939524           -0.6682140
      tbodygyrojerkmagstd fbodyaccmeanx fbodyaccmeany fbodyaccmeanz
10294          -0.6944174    -0.3724132   -0.20621247    -0.3355694
10295          -0.5967016    -0.3355388   -0.23387059    -0.3286207
10296          -0.5643632    -0.2504241   -0.06012332    -0.2756377
10297          -0.5915989    -0.3626403   -0.18680220    -0.2711378
10298          -0.6583167    -0.3783654   -0.40006993    -0.2823201
10299          -0.6083416    -0.4012226   -0.31841507    -0.2221230
      fbodyaccstdx fbodyaccstdy fbodyaccstdz fbodyaccmeanfreqx
10294   -0.3479215 -0.093630450   -0.3548239        -0.3654026
10295   -0.2698271 -0.148105510   -0.2157249        -0.4720078
10296   -0.3282253  0.008056758   -0.2160092        -0.4690450
10297   -0.3169726 -0.032618899   -0.2982284        -0.4065334
10298   -0.3024231 -0.199957890   -0.2287489        -0.4052892
10299   -0.3038541 -0.186334520   -0.1982265        -0.5377709
      fbodyaccmeanfreqy fbodyaccmeanfreqz fbodyaccjerkmeanx
10294        -0.2491084        0.06927570        -0.5440716
10295        -0.2318717       -0.24462658        -0.4508228
10296        -0.1291553       -0.19143814        -0.3177561
10297        -0.1786257        0.18436762        -0.3899408
10298        -0.4109545       -0.11919223        -0.4261218
10299        -0.2094722       -0.03540102        -0.5238330
      fbodyaccjerkmeany fbodyaccjerkmeanz fbodyaccjerkstdx
10294        -0.5213983        -0.5479350       -0.4821486
10295        -0.5439906        -0.4988520       -0.4323739
10296        -0.4116971        -0.4947402       -0.4780054
10297        -0.4348765        -0.4448655       -0.4448027
10298        -0.5838392        -0.4391983       -0.5122416
10299        -0.5971720        -0.3568914       -0.4784920
      fbodyaccjerkstdy fbodyaccjerkstdz fbodyaccjerkmeanfreqx
10294       -0.5347837       -0.6651851           -0.60979825
10295       -0.5280954       -0.5854999           -0.38658121
10296       -0.4339487       -0.5609813           -0.17579059
10297       -0.4698176       -0.6572389           -0.08233970
10298       -0.6030957       -0.5396678           -0.06420693
10299       -0.5659273       -0.4752730           -0.30471514
      fbodyaccjerkmeanfreqy fbodyaccjerkmeanfreqz fbodygyromeanx
10294            -0.3205361            -0.5788135     -0.3435613
10295            -0.5545054            -0.4777959     -0.4763887
10296            -0.3660691            -0.4744435     -0.4319631
10297            -0.3664081             0.1561755     -0.2914094
10298            -0.1828737            -0.3165199     -0.6278853
10299            -0.6287337            -0.1661142     -0.5689044
      fbodygyromeany fbodygyromeanz fbodygyrostdx fbodygyrostdy
10294     -0.5610468     -0.3417239    -0.3455524    -0.6155589
10295     -0.5218199     -0.3426978    -0.5904839    -0.5333008
10296     -0.4920759     -0.3281087    -0.4781497    -0.5383805
10297     -0.5179180     -0.3063887    -0.4635660    -0.5861540
10298     -0.5434641     -0.3680427    -0.6817483    -0.5656499
10299     -0.5114901     -0.4532693    -0.6331353    -0.5101592
      fbodygyrostdz fbodygyromeanfreqx fbodygyromeanfreqy
10294    -0.3397074        -0.38705971       -0.068323541
10295    -0.2985052        -0.03877456       -0.146433210
10296    -0.1648946        -0.25849286       -0.107232320
10297    -0.2381669        -0.08342692        0.102520330
10298    -0.3944327        -0.24241659       -0.116213420
10299    -0.3365837        -0.24056077        0.006145691
      fbodygyromeanfreqz fbodyaccmagmean fbodyaccmagstd
10294        -0.39291886      -0.3401852     -0.4240776
10295        -0.29683329      -0.2731909     -0.3321409
10296        -0.40168231      -0.2094867     -0.3169538
10297        -0.18552954      -0.2366061     -0.3772403
10298         0.03999886      -0.3147630     -0.3902011
10299        -0.52997257      -0.2884126     -0.3625984
      fbodyaccmagmeanfreq fbodybodyaccjerkmagmean fbodybodyaccjerkmagstd
10294        -0.014166679              -0.5070733             -0.5699628
10295        -0.197639940              -0.4221715             -0.4034507
10296        -0.123084380              -0.2652178             -0.3222741
10297         0.001206161              -0.2474406             -0.3589800
10298        -0.121192270              -0.3486653             -0.3832820
10299        -0.094130061              -0.3651578             -0.3823873
      fbodybodyaccjerkmagmeanfreq fbodybodygyromagmean fbodybodygyromagstd
10294                  0.03811508           -0.5414406          -0.4150161
10295                 -0.11096657           -0.4778440          -0.5712343
10296                  0.12543417           -0.4918547          -0.5565773
10297                  0.11166906           -0.6012827          -0.5633274
10298                 -0.02203329           -0.6385545          -0.5659171
10299                  0.13625728           -0.5186400          -0.5639466
      fbodybodygyromagmeanfreq fbodybodygyrojerkmagmean
10294              -0.32503719               -0.6702787
10295               0.09383895               -0.6014236
10296               0.09216161               -0.5663438
10297              -0.12206454               -0.5923314
10298              -0.22089687               -0.6797106
10299               0.03759467               -0.6159911
      fbodybodygyrojerkmagstd fbodybodygyrojerkmagmeanfreq
10294              -0.7516569                   0.15872752
10295              -0.6188288                   0.07447170
10296              -0.5925070                   0.10185944
10297              -0.6179484                  -0.06624872
10298              -0.6549599                  -0.04646651
10299              -0.6252073                  -0.01038585
      angletbodyaccmeangravity angletbodyaccjerkmeangravitymean
10294                0.5359827                       0.68930613
10295               -0.3374216                       0.34629489
10296               -0.7367010                      -0.37288894
10297               -0.1815604                       0.08857407
10298                0.4445577                      -0.81918771
10299                0.5988082                      -0.28795067
      angletbodygyromeangravitymean angletbodygyrojerkmeangravitymean
10294                    -0.9366065                       0.562374870
10295                     0.8849038                      -0.698885080
10296                    -0.6574205                       0.322548500
10297                     0.6966635                       0.363138710
10298                     0.9292941                      -0.008398249
10299                     0.8760299                      -0.024965139
      anglexgravitymean angleygravitymean anglezgravitymean source
10294        -0.6467543         0.2821502         0.1811516   test
10295        -0.6517323         0.2746268         0.1847843   test
10296        -0.6551809         0.2735783         0.1824121   test
10297        -0.6553568         0.2744788         0.1811835   test
10298        -0.6597186         0.2647816         0.1875629   test
10299        -0.6600802         0.2639362         0.1881034   test
      src_rownum row_num
10294 test_02942   10294
10295 test_02943   10295
10296 test_02944   10296
10297 test_02945   10297
10298 test_02946   10298
10299 test_02947   10299
```


# The Assignment question


```r
  # assignment question: group by subjects and activities summarizing selected columns by the mean
  # data frame: train_test_merged
  # group by subjects and activities
  by_SubjectActivity <- group_by(train_test_merged, subjects_id, activity_name)
  
  # summary showing the mean of mean and std columns by subjects and activities
  # acting on the merged measurement data frames
  # assign select variable names (mean, std) to a vector
  mean_std_vars <- get_variables_matching_keywords(valid_column_names, keywords)
  
  # summary
  sum_SubjectActivity <<- summarize_at(by_SubjectActivity, .cols = mean_std_vars,
                                       .funs = mean) 
```



```r
  cat(mean_std_vars)
```

```
tbodyaccmeanx tbodyaccmeany tbodyaccmeanz tbodyaccstdx tbodyaccstdy tbodyaccstdz tgravityaccmeanx tgravityaccmeany tgravityaccmeanz tgravityaccstdx tgravityaccstdy tgravityaccstdz tbodyaccjerkmeanx tbodyaccjerkmeany tbodyaccjerkmeanz tbodyaccjerkstdx tbodyaccjerkstdy tbodyaccjerkstdz tbodygyromeanx tbodygyromeany tbodygyromeanz tbodygyrostdx tbodygyrostdy tbodygyrostdz tbodygyrojerkmeanx tbodygyrojerkmeany tbodygyrojerkmeanz tbodygyrojerkstdx tbodygyrojerkstdy tbodygyrojerkstdz tbodyaccmagmean tbodyaccmagstd tgravityaccmagmean tgravityaccmagstd tbodyaccjerkmagmean tbodyaccjerkmagstd tbodygyromagmean tbodygyromagstd tbodygyrojerkmagmean tbodygyrojerkmagstd fbodyaccmeanx fbodyaccmeany fbodyaccmeanz fbodyaccstdx fbodyaccstdy fbodyaccstdz fbodyaccmeanfreqx fbodyaccmeanfreqy fbodyaccmeanfreqz fbodyaccjerkmeanx fbodyaccjerkmeany fbodyaccjerkmeanz fbodyaccjerkstdx fbodyaccjerkstdy fbodyaccjerkstdz fbodyaccjerkmeanfreqx fbodyaccjerkmeanfreqy fbodyaccjerkmeanfreqz fbodygyromeanx fbodygyromeany fbodygyromeanz fbodygyrostdx fbodygyrostdy fbodygyrostdz fbodygyromeanfreqx fbodygyromeanfreqy fbodygyromeanfreqz fbodyaccmagmean fbodyaccmagstd fbodyaccmagmeanfreq fbodybodyaccjerkmagmean fbodybodyaccjerkmagstd fbodybodyaccjerkmagmeanfreq fbodybodygyromagmean fbodybodygyromagstd fbodybodygyromagmeanfreq fbodybodygyrojerkmagmean fbodybodygyrojerkmagstd fbodybodygyrojerkmagmeanfreq angletbodyaccmeangravity angletbodyaccjerkmeangravitymean angletbodygyromeangravitymean angletbodygyrojerkmeangravitymean anglexgravitymean angleygravitymean anglezgravitymean
```

```r
  head(sum_SubjectActivity)
```

```
Source: local data frame [6 x 88]
Groups: subjects_id [1]

  subjects_id      activity_name tbodyaccmeanx tbodyaccmeany tbodyaccmeanz
        <int>             <fctr>         <dbl>         <dbl>         <dbl>
1           1             LAYING     0.2215982  -0.040513953    -0.1132036
2           1            SITTING     0.2612376  -0.001308288    -0.1045442
3           1           STANDING     0.2789176  -0.016137590    -0.1106018
4           1            WALKING     0.2773308  -0.017383819    -0.1111481
5           1 WALKING_DOWNSTAIRS     0.2891883  -0.009918505    -0.1075662
6           1   WALKING_UPSTAIRS     0.2554617  -0.023953149    -0.0973020
# ... with 83 more variables: tbodyaccstdx <dbl>, tbodyaccstdy <dbl>,
#   tbodyaccstdz <dbl>, tgravityaccmeanx <dbl>, tgravityaccmeany <dbl>,
#   tgravityaccmeanz <dbl>, tgravityaccstdx <dbl>, tgravityaccstdy <dbl>,
#   tgravityaccstdz <dbl>, tbodyaccjerkmeanx <dbl>,
#   tbodyaccjerkmeany <dbl>, tbodyaccjerkmeanz <dbl>,
#   tbodyaccjerkstdx <dbl>, tbodyaccjerkstdy <dbl>,
#   tbodyaccjerkstdz <dbl>, tbodygyromeanx <dbl>, tbodygyromeany <dbl>,
#   tbodygyromeanz <dbl>, tbodygyrostdx <dbl>, tbodygyrostdy <dbl>,
#   tbodygyrostdz <dbl>, tbodygyrojerkmeanx <dbl>,
#   tbodygyrojerkmeany <dbl>, tbodygyrojerkmeanz <dbl>,
#   tbodygyrojerkstdx <dbl>, tbodygyrojerkstdy <dbl>,
#   tbodygyrojerkstdz <dbl>, tbodyaccmagmean <dbl>, tbodyaccmagstd <dbl>,
#   tgravityaccmagmean <dbl>, tgravityaccmagstd <dbl>,
#   tbodyaccjerkmagmean <dbl>, tbodyaccjerkmagstd <dbl>,
#   tbodygyromagmean <dbl>, tbodygyromagstd <dbl>,
#   tbodygyrojerkmagmean <dbl>, tbodygyrojerkmagstd <dbl>,
#   fbodyaccmeanx <dbl>, fbodyaccmeany <dbl>, fbodyaccmeanz <dbl>,
#   fbodyaccstdx <dbl>, fbodyaccstdy <dbl>, fbodyaccstdz <dbl>,
#   fbodyaccmeanfreqx <dbl>, fbodyaccmeanfreqy <dbl>,
#   fbodyaccmeanfreqz <dbl>, fbodyaccjerkmeanx <dbl>,
#   fbodyaccjerkmeany <dbl>, fbodyaccjerkmeanz <dbl>,
#   fbodyaccjerkstdx <dbl>, fbodyaccjerkstdy <dbl>,
#   fbodyaccjerkstdz <dbl>, fbodyaccjerkmeanfreqx <dbl>,
#   fbodyaccjerkmeanfreqy <dbl>, fbodyaccjerkmeanfreqz <dbl>,
#   fbodygyromeanx <dbl>, fbodygyromeany <dbl>, fbodygyromeanz <dbl>,
#   fbodygyrostdx <dbl>, fbodygyrostdy <dbl>, fbodygyrostdz <dbl>,
#   fbodygyromeanfreqx <dbl>, fbodygyromeanfreqy <dbl>,
#   fbodygyromeanfreqz <dbl>, fbodyaccmagmean <dbl>, fbodyaccmagstd <dbl>,
#   fbodyaccmagmeanfreq <dbl>, fbodybodyaccjerkmagmean <dbl>,
#   fbodybodyaccjerkmagstd <dbl>, fbodybodyaccjerkmagmeanfreq <dbl>,
#   fbodybodygyromagmean <dbl>, fbodybodygyromagstd <dbl>,
#   fbodybodygyromagmeanfreq <dbl>, fbodybodygyrojerkmagmean <dbl>,
#   fbodybodygyrojerkmagstd <dbl>, fbodybodygyrojerkmagmeanfreq <dbl>,
#   angletbodyaccmeangravity <dbl>,
#   angletbodyaccjerkmeangravitymean <dbl>,
#   angletbodygyromeangravitymean <dbl>,
#   angletbodygyrojerkmeangravitymean <dbl>, anglexgravitymean <dbl>,
#   angleygravitymean <dbl>, anglezgravitymean <dbl>
```

```r
  tail(sum_SubjectActivity)
```

```
Source: local data frame [6 x 88]
Groups: subjects_id [1]

  subjects_id      activity_name tbodyaccmeanx tbodyaccmeany tbodyaccmeanz
        <int>             <fctr>         <dbl>         <dbl>         <dbl>
1          30             LAYING     0.2810339  -0.019449410   -0.10365815
2          30            SITTING     0.2683361  -0.008047313   -0.09951545
3          30           STANDING     0.2771127  -0.017016389   -0.10875621
4          30            WALKING     0.2764068  -0.017588039   -0.09862471
5          30 WALKING_DOWNSTAIRS     0.2831906  -0.017438390   -0.09997814
6          30   WALKING_UPSTAIRS     0.2714156  -0.025331170   -0.12469749
# ... with 83 more variables: tbodyaccstdx <dbl>, tbodyaccstdy <dbl>,
#   tbodyaccstdz <dbl>, tgravityaccmeanx <dbl>, tgravityaccmeany <dbl>,
#   tgravityaccmeanz <dbl>, tgravityaccstdx <dbl>, tgravityaccstdy <dbl>,
#   tgravityaccstdz <dbl>, tbodyaccjerkmeanx <dbl>,
#   tbodyaccjerkmeany <dbl>, tbodyaccjerkmeanz <dbl>,
#   tbodyaccjerkstdx <dbl>, tbodyaccjerkstdy <dbl>,
#   tbodyaccjerkstdz <dbl>, tbodygyromeanx <dbl>, tbodygyromeany <dbl>,
#   tbodygyromeanz <dbl>, tbodygyrostdx <dbl>, tbodygyrostdy <dbl>,
#   tbodygyrostdz <dbl>, tbodygyrojerkmeanx <dbl>,
#   tbodygyrojerkmeany <dbl>, tbodygyrojerkmeanz <dbl>,
#   tbodygyrojerkstdx <dbl>, tbodygyrojerkstdy <dbl>,
#   tbodygyrojerkstdz <dbl>, tbodyaccmagmean <dbl>, tbodyaccmagstd <dbl>,
#   tgravityaccmagmean <dbl>, tgravityaccmagstd <dbl>,
#   tbodyaccjerkmagmean <dbl>, tbodyaccjerkmagstd <dbl>,
#   tbodygyromagmean <dbl>, tbodygyromagstd <dbl>,
#   tbodygyrojerkmagmean <dbl>, tbodygyrojerkmagstd <dbl>,
#   fbodyaccmeanx <dbl>, fbodyaccmeany <dbl>, fbodyaccmeanz <dbl>,
#   fbodyaccstdx <dbl>, fbodyaccstdy <dbl>, fbodyaccstdz <dbl>,
#   fbodyaccmeanfreqx <dbl>, fbodyaccmeanfreqy <dbl>,
#   fbodyaccmeanfreqz <dbl>, fbodyaccjerkmeanx <dbl>,
#   fbodyaccjerkmeany <dbl>, fbodyaccjerkmeanz <dbl>,
#   fbodyaccjerkstdx <dbl>, fbodyaccjerkstdy <dbl>,
#   fbodyaccjerkstdz <dbl>, fbodyaccjerkmeanfreqx <dbl>,
#   fbodyaccjerkmeanfreqy <dbl>, fbodyaccjerkmeanfreqz <dbl>,
#   fbodygyromeanx <dbl>, fbodygyromeany <dbl>, fbodygyromeanz <dbl>,
#   fbodygyrostdx <dbl>, fbodygyrostdy <dbl>, fbodygyrostdz <dbl>,
#   fbodygyromeanfreqx <dbl>, fbodygyromeanfreqy <dbl>,
#   fbodygyromeanfreqz <dbl>, fbodyaccmagmean <dbl>, fbodyaccmagstd <dbl>,
#   fbodyaccmagmeanfreq <dbl>, fbodybodyaccjerkmagmean <dbl>,
#   fbodybodyaccjerkmagstd <dbl>, fbodybodyaccjerkmagmeanfreq <dbl>,
#   fbodybodygyromagmean <dbl>, fbodybodygyromagstd <dbl>,
#   fbodybodygyromagmeanfreq <dbl>, fbodybodygyrojerkmagmean <dbl>,
#   fbodybodygyrojerkmagstd <dbl>, fbodybodygyrojerkmagmeanfreq <dbl>,
#   angletbodyaccmeangravity <dbl>,
#   angletbodyaccjerkmeangravitymean <dbl>,
#   angletbodygyromeangravitymean <dbl>,
#   angletbodygyrojerkmeangravitymean <dbl>, anglexgravitymean <dbl>,
#   angleygravitymean <dbl>, anglezgravitymean <dbl>
```

```r
  str(sum_SubjectActivity)
```

```
Classes 'grouped_df', 'tbl_df', 'tbl' and 'data.frame':	180 obs. of  88 variables:
 $ subjects_id                      : int  1 1 1 1 1 1 2 2 2 2 ...
 $ activity_name                    : Factor w/ 6 levels "LAYING","SITTING",..: 1 2 3 4 5 6 1 2 3 4 ...
 $ tbodyaccmeanx                    : num  0.222 0.261 0.279 0.277 0.289 ...
 $ tbodyaccmeany                    : num  -0.04051 -0.00131 -0.01614 -0.01738 -0.00992 ...
 $ tbodyaccmeanz                    : num  -0.113 -0.105 -0.111 -0.111 -0.108 ...
 $ tbodyaccstdx                     : num  -0.928 -0.977 -0.996 -0.284 0.03 ...
 $ tbodyaccstdy                     : num  -0.8368 -0.9226 -0.9732 0.1145 -0.0319 ...
 $ tbodyaccstdz                     : num  -0.826 -0.94 -0.98 -0.26 -0.23 ...
 $ tgravityaccmeanx                 : num  -0.249 0.832 0.943 0.935 0.932 ...
 $ tgravityaccmeany                 : num  0.706 0.204 -0.273 -0.282 -0.267 ...
 $ tgravityaccmeanz                 : num  0.4458 0.332 0.0135 -0.0681 -0.0621 ...
 $ tgravityaccstdx                  : num  -0.897 -0.968 -0.994 -0.977 -0.951 ...
 $ tgravityaccstdy                  : num  -0.908 -0.936 -0.981 -0.971 -0.937 ...
 $ tgravityaccstdz                  : num  -0.852 -0.949 -0.976 -0.948 -0.896 ...
 $ tbodyaccjerkmeanx                : num  0.0811 0.0775 0.0754 0.074 0.0542 ...
 $ tbodyaccjerkmeany                : num  0.003838 -0.000619 0.007976 0.028272 0.02965 ...
 $ tbodyaccjerkmeanz                : num  0.01083 -0.00337 -0.00369 -0.00417 -0.01097 ...
 $ tbodyaccjerkstdx                 : num  -0.9585 -0.9864 -0.9946 -0.1136 -0.0123 ...
 $ tbodyaccjerkstdy                 : num  -0.924 -0.981 -0.986 0.067 -0.102 ...
 $ tbodyaccjerkstdz                 : num  -0.955 -0.988 -0.992 -0.503 -0.346 ...
 $ tbodygyromeanx                   : num  -0.0166 -0.0454 -0.024 -0.0418 -0.0351 ...
 $ tbodygyromeany                   : num  -0.0645 -0.0919 -0.0594 -0.0695 -0.0909 ...
 $ tbodygyromeanz                   : num  0.1487 0.0629 0.0748 0.0849 0.0901 ...
 $ tbodygyrostdx                    : num  -0.874 -0.977 -0.987 -0.474 -0.458 ...
 $ tbodygyrostdy                    : num  -0.9511 -0.9665 -0.9877 -0.0546 -0.1263 ...
 $ tbodygyrostdz                    : num  -0.908 -0.941 -0.981 -0.344 -0.125 ...
 $ tbodygyrojerkmeanx               : num  -0.1073 -0.0937 -0.0996 -0.09 -0.074 ...
 $ tbodygyrojerkmeany               : num  -0.0415 -0.0402 -0.0441 -0.0398 -0.044 ...
 $ tbodygyrojerkmeanz               : num  -0.0741 -0.0467 -0.049 -0.0461 -0.027 ...
 $ tbodygyrojerkstdx                : num  -0.919 -0.992 -0.993 -0.207 -0.487 ...
 $ tbodygyrojerkstdy                : num  -0.968 -0.99 -0.995 -0.304 -0.239 ...
 $ tbodygyrojerkstdz                : num  -0.958 -0.988 -0.992 -0.404 -0.269 ...
 $ tbodyaccmagmean                  : num  -0.8419 -0.9485 -0.9843 -0.137 0.0272 ...
 $ tbodyaccmagstd                   : num  -0.7951 -0.9271 -0.9819 -0.2197 0.0199 ...
 $ tgravityaccmagmean               : num  -0.8419 -0.9485 -0.9843 -0.137 0.0272 ...
 $ tgravityaccmagstd                : num  -0.7951 -0.9271 -0.9819 -0.2197 0.0199 ...
 $ tbodyaccjerkmagmean              : num  -0.9544 -0.9874 -0.9924 -0.1414 -0.0894 ...
 $ tbodyaccjerkmagstd               : num  -0.9282 -0.9841 -0.9931 -0.0745 -0.0258 ...
 $ tbodygyromagmean                 : num  -0.8748 -0.9309 -0.9765 -0.161 -0.0757 ...
 $ tbodygyromagstd                  : num  -0.819 -0.935 -0.979 -0.187 -0.226 ...
 $ tbodygyrojerkmagmean             : num  -0.963 -0.992 -0.995 -0.299 -0.295 ...
 $ tbodygyrojerkmagstd              : num  -0.936 -0.988 -0.995 -0.325 -0.307 ...
 $ fbodyaccmeanx                    : num  -0.9391 -0.9796 -0.9952 -0.2028 0.0382 ...
 $ fbodyaccmeany                    : num  -0.86707 -0.94408 -0.97707 0.08971 0.00155 ...
 $ fbodyaccmeanz                    : num  -0.883 -0.959 -0.985 -0.332 -0.226 ...
 $ fbodyaccstdx                     : num  -0.9244 -0.9764 -0.996 -0.3191 0.0243 ...
 $ fbodyaccstdy                     : num  -0.834 -0.917 -0.972 0.056 -0.113 ...
 $ fbodyaccstdz                     : num  -0.813 -0.934 -0.978 -0.28 -0.298 ...
 $ fbodyaccmeanfreqx                : num  -0.1588 -0.0495 0.0865 -0.2075 -0.3074 ...
 $ fbodyaccmeanfreqy                : num  0.0975 0.0759 0.1175 0.1131 0.0632 ...
 $ fbodyaccmeanfreqz                : num  0.0894 0.2388 0.2449 0.0497 0.2943 ...
 $ fbodyaccjerkmeanx                : num  -0.9571 -0.9866 -0.9946 -0.1705 -0.0277 ...
 $ fbodyaccjerkmeany                : num  -0.9225 -0.9816 -0.9854 -0.0352 -0.1287 ...
 $ fbodyaccjerkmeanz                : num  -0.948 -0.986 -0.991 -0.469 -0.288 ...
 $ fbodyaccjerkstdx                 : num  -0.9642 -0.9875 -0.9951 -0.1336 -0.0863 ...
 $ fbodyaccjerkstdy                 : num  -0.932 -0.983 -0.987 0.107 -0.135 ...
 $ fbodyaccjerkstdz                 : num  -0.961 -0.988 -0.992 -0.535 -0.402 ...
 $ fbodyaccjerkmeanfreqx            : num  0.132 0.257 0.314 -0.209 -0.253 ...
 $ fbodyaccjerkmeanfreqy            : num  0.0245 0.0475 0.0392 -0.3862 -0.3376 ...
 $ fbodyaccjerkmeanfreqz            : num  0.02439 0.09239 0.13858 -0.18553 0.00937 ...
 $ fbodygyromeanx                   : num  -0.85 -0.976 -0.986 -0.339 -0.352 ...
 $ fbodygyromeany                   : num  -0.9522 -0.9758 -0.989 -0.1031 -0.0557 ...
 $ fbodygyromeanz                   : num  -0.9093 -0.9513 -0.9808 -0.2559 -0.0319 ...
 $ fbodygyrostdx                    : num  -0.882 -0.978 -0.987 -0.517 -0.495 ...
 $ fbodygyrostdy                    : num  -0.9512 -0.9623 -0.9871 -0.0335 -0.1814 ...
 $ fbodygyrostdz                    : num  -0.917 -0.944 -0.982 -0.437 -0.238 ...
 $ fbodygyromeanfreqx               : num  -0.00355 0.18915 -0.12029 0.01478 -0.10045 ...
 $ fbodygyromeanfreqy               : num  -0.0915 0.0631 -0.0447 -0.0658 0.0826 ...
 $ fbodygyromeanfreqz               : num  0.010458 -0.029784 0.100608 0.000773 -0.075676 ...
 $ fbodyaccmagmean                  : num  -0.8618 -0.9478 -0.9854 -0.1286 0.0966 ...
 $ fbodyaccmagstd                   : num  -0.798 -0.928 -0.982 -0.398 -0.187 ...
 $ fbodyaccmagmeanfreq              : num  0.0864 0.2367 0.2846 0.1906 0.1192 ...
 $ fbodybodyaccjerkmagmean          : num  -0.9333 -0.9853 -0.9925 -0.0571 0.0262 ...
 $ fbodybodyaccjerkmagstd           : num  -0.922 -0.982 -0.993 -0.103 -0.104 ...
 $ fbodybodyaccjerkmagmeanfreq      : num  0.2664 0.3519 0.4222 0.0938 0.0765 ...
 $ fbodybodygyromagmean             : num  -0.862 -0.958 -0.985 -0.199 -0.186 ...
 $ fbodybodygyromagstd              : num  -0.824 -0.932 -0.978 -0.321 -0.398 ...
 $ fbodybodygyromagmeanfreq         : num  -0.139775 -0.000262 -0.028606 0.268844 0.349614 ...
 $ fbodybodygyrojerkmagmean         : num  -0.942 -0.99 -0.995 -0.319 -0.282 ...
 $ fbodybodygyrojerkmagstd          : num  -0.933 -0.987 -0.995 -0.382 -0.392 ...
 $ fbodybodygyrojerkmagmeanfreq     : num  0.176 0.185 0.334 0.191 0.19 ...
 $ angletbodyaccmeangravity         : num  0.021366 0.027442 -0.000222 0.060454 -0.002695 ...
 $ angletbodyaccjerkmeangravitymean : num  0.00306 0.02971 0.02196 -0.00793 0.08993 ...
 $ angletbodygyromeangravitymean    : num  -0.00167 0.0677 -0.03379 0.01306 0.06334 ...
 $ angletbodygyrojerkmeangravitymean: num  0.0844 -0.0649 -0.0279 -0.0187 -0.04 ...
 $ anglexgravitymean                : num  0.427 -0.591 -0.743 -0.729 -0.744 ...
 $ angleygravitymean                : num  -0.5203 -0.0605 0.2702 0.277 0.2672 ...
 $ anglezgravitymean                : num  -0.3524 -0.218 0.0123 0.0689 0.065 ...
 - attr(*, "vars")=List of 1
  ..$ : symbol subjects_id
 - attr(*, "drop")= logi TRUE
```

## Exporting the data

```r
  # output of tidy dataset containing summary of subjects and activities 
  # and the mean of selected columns.
  write.table(sum_SubjectActivity, "sum_subjects_activities.txt")
```


```r
  summary_read <- read.table("sum_subjects_activities.txt")
  short_summary(summary_read)
```

```
Observations: 	 180 			First variables: subjects_id activity_name tbodyaccmeanx tbodyaccmeany tbodyaccmeanz tbodyaccstdx 
Variables: 	 88 			Last variables: angletbodyaccjerkmeangravitymean angletbodygyromeangravitymean angletbodygyrojerkmeangravitymean anglexgravitymean angleygravitymean anglezgravitymean 

First observations
  subjects_id tbodygyromeany fbodyaccmeany fbodygyrostdz anglezgravitymean
1           1    -0.06448612  -0.867065205    -0.9165825       -0.35241311
2           1    -0.09192415  -0.944084550    -0.9439178       -0.21801723
3           1    -0.05939722  -0.977070848    -0.9823453        0.01225285
4           1    -0.06953005   0.089712726    -0.4365622        0.06885891
5           1    -0.09093713   0.001549908    -0.2384436        0.06500471
6           1    -0.16617002  -0.190976721    -0.5717078        0.07416637

Summary of selected variables
```

```
  subjects_id   tbodygyromeany     fbodyaccmeany      fbodygyrostdz    
 Min.   : 1.0   Min.   :-0.20421   Min.   :-0.98903   Min.   :-0.9867  
 1st Qu.: 8.0   1st Qu.:-0.08955   1st Qu.:-0.95361   1st Qu.:-0.9643  
 Median :15.5   Median :-0.07318   Median :-0.59498   Median :-0.8224  
 Mean   :15.5   Mean   :-0.07426   Mean   :-0.48873   Mean   :-0.6577  
 3rd Qu.:23.0   3rd Qu.:-0.06113   3rd Qu.:-0.06341   3rd Qu.:-0.3916  
 Max.   :30.0   Max.   : 0.02747   Max.   : 0.52419   Max.   : 0.5225  
 anglezgravitymean  
 Min.   :-0.873649  
 1st Qu.:-0.083912  
 Median : 0.005079  
 Mean   :-0.040436  
 3rd Qu.: 0.106190  
 Max.   : 0.390444  
```

```r
  # str(summary_read)
```


# Getting the data. Acquiring the datasets

We start by downloading the zipped file containing all the datasets and associated files.
We load the library `downloader` to allow us the use of the function `download()`.

Since we want to make this analysis reproducible, we added the capability of detecting if the folder `data` exists in the folder structure. If it doesn't exist, the script will create it for the user. Downloading and extracting the files will take few minutes.


```r
library(downloader)

if(!file.exists("./data")){dir.create("./data")}

fileUrl <- "https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip"

# download(fileUrl, dest="dataset.zip", mode="wb") 
# unzip ("dataset.zip", exdir = "./data")
```

